# TODO: allow queries

extend type User {
  """
  All the recent activity from this user in chronological order
  """
  activity(actionType: String, after: DateTime, before: DateTime, cursor: DateTime, limit: Int! = 25): ActivityCollection
    @hasRole(role: "server:user")
    @hasScope(scope: "users:read")
  timeline(after: DateTime, before: DateTime, cursor: DateTime, limit: Int! = 25): ActivityCollection
    @hasRole(role: "server:user")
    @hasScopes(scopes: ["users:read", "streams:read"])
}

extend type Stream {
  """
  All the recent activity on this stream in chronological order
  """
  activity(actionType: String, after: DateTime, before: DateTime, cursor: DateTime, limit: Int! = 25): ActivityCollection
    @hasRole(role: "server:user")
    @hasScope(scope: "streams:read")
}

extend type Branch {
  """
  All the recent activity on this branch in chronological order
  """
  activity(actionType: String, after: DateTime, before: DateTime, cursor: DateTime, limit: Int! = 25): ActivityCollection
    @hasRole(role: "server:user")
    @hasScope(scope: "streams:read")
}

extend type Mutation {
  commitReadReceiptCreate(input: CreateReadReceiptInput!, after: DateTime, before: DateTime, cursor: DateTime): JSONObject
    @hasRole(role: "server:user")
}

input CreateReadReceiptInput {
  applicationName: String!
  streamId: String!
  commitId: String!
  branchName: String!
}

type ActivityCollection {
  totalCount: Int!
  cursor: String
  items: [Activity]
}

type Activity {
  actionType: String!
  info: JSONObject!
  userId: String!
  streamId: String
  resourceId: String!
  resourceType: String!
  time: DateTime!
  message: String!
}
